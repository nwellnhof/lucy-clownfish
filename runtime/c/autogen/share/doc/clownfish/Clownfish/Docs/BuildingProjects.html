<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<!--
***********************************************

!!!! DO NOT EDIT !!!!

This file was auto-generated by cfc.

***********************************************

Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<meta name="viewport" content="width=device-width" />
<title>Clownfish::Docs::BuildingProjects</title>
<style type="text/css">
body {
    max-width: 48em;
    font: 0.85em/1.4 sans-serif;
}
a {
    color: #23b;
}
table {
    border-collapse: collapse;
}
td {
    padding: 0;
}
td.label {
    padding-right: 2em;
    font-weight: bold;
}
dt {
    font-weight: bold;
}
pre {
    border: 1px solid #ccc;
    padding: 0.2em 0.4em;
    background: #f6f6f6;
    font-size: 0.92em;
}
pre a {
    text-decoration: none;
}
pre, code {
    font-family: "Consolas", "Menlo", monospace;
}
span.prefix, span.comment {
    color: #888;
}
</style>
</head>
<body>
<h1>Building Apache Clownfish projects in C environments</h1>
<p>The following steps are required to build a project that uses
Apache Clownfish:</p>
<ul>
<li>Run the <code>cfc</code> command-line application (Clownfish compiler) to
generate C headers, C source files, and documentation.</li>
<li>Include the C headers generated by the Clownfish compiler in your
own code to <a href="../../Clownfish/Docs/ClassIntro.html">work with Clownfish objects</a>.</li>
<li>Compile an additional C source file generated by CFC.</li>
<li>Link your object code, the object code from the generated file,
and the Clownfish runtime library.</li>
</ul>
<h2>Running cfc</h2>
<pre><code>cfc [--source=&lt;dir&gt;] [--include=&lt;dir&gt;] [--parcel=&lt;name&gt;]
    --dest=&lt;dir&gt;
    [--header=&lt;file&gt;] [--footer=&lt;file&gt;]
</code></pre>
<h3>–source</h3>
<p>Every <code>--source</code> argument adds a directory to the list of source
directories to search for source parcels. For every source parcel
found, CFC generates C headers, a C source file, and documentation.</p>
<p>The source directories are scanned for Clownfish parcel definitions
(<code>.cfp</code>), Clownfish headers (<code>.cfh</code>), and standalone documentation
in Markdown format (<code>.md</code>).</p>
<p>This option may be specified multiple times.</p>
<h3>–include</h3>
<p>Every <code>--include</code> argument adds a directory to the list of include
directories. CFC generates C headers for parcels from an include
directory only if they’re required by a source parcel or if they’re
specified with the <code>--parcel</code> option. Only C headers are generated
for included parcels, no C source code or documentation.</p>
<p>The include directories are scanned for Clownfish parcel
definitions (<code>.cfp</code>) and Clownfish headers (<code>.cfh</code>).</p>
<p>After the directories specified on the command-line, the following
directories are processed:</p>
<ul>
<li>Directories from the environment variable <code>CLOWNFISH_INCLUDE</code>.
This variable contains a colon-separated list of directories.</li>
<li>On UNIX-like systems <code>/usr/local/share/clownfish/include</code> and
<code>/usr/share/clownfish/include</code>.</li>
</ul>
<p>This option may be specified multiple times.</p>
<h3>–parcel</h3>
<p>Adds a parcel to the list of prerequisite parcels to make sure that
its C headers are generated. This is useful when running without the
<code>--source</code> option. For example, a project that doesn’t define its
own Clownfish classes can generate the C headers for the Clownfish
runtime with:</p>
<pre><code>cfc --parcel=Clownfish --dest=autogen
</code></pre>
<p>This option may be specified multiple times.</p>
<h3>–dest</h3>
<p>The destination directory for generated files. By convention,
the name <code>autogen</code> is used.</p>
<p>CFC creates the following subdirectories in the destination
directory:</p>
<ul>
<li><code>include</code> contains generated C headers.</li>
<li><code>sources</code> contains generated C source files.</li>
<li><code>man</code> contains generated man pages.</li>
<li><code>share/doc/clownfish</code> contains generated HTML documentation.</li>
</ul>
<p>This option is required.</p>
<h3>–header</h3>
<p>Specifies a file whose contents are added as a comment on top of
each generated file.</p>
<h3>–footer</h3>
<p>Specifies a file whose contents are added as a comment on the
bottom of each generated file.</p>
<h2>Including the generated C headers</h2>
<p>The C header files generated with <code>cfc</code> can be found in
<code>autogen/include</code>. You should add this directory to your compiler’s
search path, for example using <code>-Iautogen/include</code> under GCC.</p>
<p>One C header file is generated for every Clownfish header (.cfh) file.
C code that makes use of a class defined in the .cfh file must include
the respective C header. The Clownfish compiler also creates a few
other internal C header files.</p>
<h2>Compiling the generated source files</h2>
<p><code>cfc</code> creates one source file for every parcel in
<code>autogen/sources/{parcel_nick}_parcel.c</code>. These files must be
compiled with <code>autogen/include</code> added to the header search path.</p>
<h2>Linking</h2>
<p>When linking, add the object files of the CFC-generated code created
in the previous step. You must also link the shared library of the
Clownfish runtime (<code>-lcfish</code> under GCC).</p>
</body>
</html>
